model Author {
  id                        String                @id
  slug                      String                @unique
  year                      Int?
  numberOfBooks             Int                   @default(0)
  transliteration           String?
  /// [AuthorExtraProperties]
  extraProperties           Json                  @default("{}")
  createdAt                 DateTime              @default(now())
  updatedAt                 DateTime?             @updatedAt
  yearStatus                AuthorYearStatus?
  otherNameTransliterations String[]
  alternateSlugs            AuthorAlternateSlug[]
  bioTranslations           AuthorBio[]
  otherNameTranslations     AuthorOtherNames[]
  primaryNameTranslations   AuthorPrimaryName[]
  books                     Book[]
  empires                   Empire[]              @relation("AuthorToEmpire")
  regions                   Region[]              @relation("AuthorToRegion")
}

model AuthorAlternateSlug {
  slug     String @id @unique
  authorId String
  author   Author @relation(fields: [authorId], references: [id], onDelete: Cascade)
}

model AuthorBio {
  locale   String
  text     String
  authorId String
  author   Author @relation(fields: [authorId], references: [id], onDelete: Cascade)

  @@id([authorId, locale])
}

model AuthorPrimaryName {
  locale   String
  text     String
  authorId String
  author   Author @relation(fields: [authorId], references: [id], onDelete: Cascade)

  @@id([authorId, locale])
}

model AuthorOtherNames {
  locale   String
  texts    String[]
  authorId String
  author   Author   @relation(fields: [authorId], references: [id], onDelete: Cascade)

  @@id([authorId, locale])
}

model Book {
  id                        String              @id
  slug                      String              @unique
  numberOfVersions          Int                 @default(0)
  authorId                  String
  /// [BookVersion]
  versions                  Json[]
  transliteration           String?
  /// [BookExtraProperties]
  extraProperties           Json                @default("{}")
  createdAt                 DateTime            @default(now())
  updatedAt                 DateTime?           @updatedAt
  coverImageUrl             String?
  /// [BookPhysicalDetails]
  physicalDetails           Json?
  otherNameTransliterations String[]
  author                    Author              @relation(fields: [authorId], references: [id], onDelete: Cascade)
  alternateSlugs            BookAlternateSlug[]
  otherNameTranslations     BookOtherNames[]
  primaryNameTranslations   BookPrimaryName[]
  bookVersions              BookVersion[]
  advancedGenres            AdvancedGenre[]     @relation("AdvancedGenreToBook")
  genres                    Genre[]             @relation("BookToGenre")
  collections               Collection[]        @relation("CollectionBooks")
}

model BookVersion {
  id                String            @id
  source            BookVersionSource
  value             String
  investigator      String?
  publisher         String?
  publisherLocation String?
  editionNumber     String?
  publicationYear   String?
  aiSupported       Boolean           @default(false)
  keywordSupported  Boolean           @default(false)
  pdfUrl            String?
  ocrBookId         String?
  /// [BookVersionSplitsData]
  splitsData        Json?
  bookId            String
  book              Book              @relation(fields: [bookId], references: [id], onDelete: Cascade)
}

model BookAlternateSlug {
  slug   String @id @unique
  bookId String
  book   Book   @relation(fields: [bookId], references: [id], onDelete: Cascade)
}

model BookPrimaryName {
  locale String
  text   String
  bookId String
  book   Book   @relation(fields: [bookId], references: [id], onDelete: Cascade)

  @@id([bookId, locale])
}

model BookOtherNames {
  locale String
  texts  String[]
  bookId String
  book   Book     @relation(fields: [bookId], references: [id], onDelete: Cascade)

  @@id([bookId, locale])
}

model Genre {
  id               String      @id
  slug             String      @unique
  numberOfBooks    Int         @default(0)
  transliteration  String?
  /// [GenreExtraProperties]
  extraProperties  Json        @default("{}")
  createdAt        DateTime    @default(now())
  updatedAt        DateTime?   @updatedAt
  nameTranslations GenreName[]
  books            Book[]      @relation("BookToGenre")
}

model GenreName {
  locale  String
  text    String
  genreId String
  genre   Genre  @relation(fields: [genreId], references: [id], onDelete: Cascade)

  @@id([genreId, locale])
}

model AdvancedGenre {
  id               String              @id
  slug             String              @unique
  transliteration  String?
  /// [AdvancedGenreExtraProperties]
  extraProperties  Json                @default("{}")
  numberOfBooks    Int                 @default(0)
  createdAt        DateTime            @default(now())
  updatedAt        DateTime?           @updatedAt
  parentGenre      String?
  nameTranslations AdvancedGenreName[]
  books            Book[]              @relation("AdvancedGenreToBook")
}

model AdvancedGenreName {
  locale  String
  text    String
  genreId String
  genre   AdvancedGenre @relation(fields: [genreId], references: [id], onDelete: Cascade)

  @@id([genreId, locale])
}

model Region {
  id                         String              @id
  slug                       String              @unique
  numberOfAuthors            Int                 @default(0)
  numberOfBooks              Int                 @default(0)
  currentNameTransliteration String?
  transliteration            String?
  createdAt                  DateTime            @default(now())
  updatedAt                  DateTime?           @updatedAt
  currentNameTranslations    RegionCurrentName[]
  nameTranslations           RegionName[]
  overviewTranslations       RegionOverview[]
  author                     Author[]            @relation("AuthorToRegion")
  empire                     Empire[]            @relation("RegionToEmpire")
}

model RegionCurrentName {
  locale   String
  text     String
  regionId String
  region   Region @relation(fields: [regionId], references: [id], onDelete: Cascade)

  @@id([regionId, locale])
}

model RegionName {
  locale   String
  text     String
  regionId String
  region   Region @relation(fields: [regionId], references: [id], onDelete: Cascade)

  @@id([regionId, locale])
}

model RegionOverview {
  locale   String
  text     String
  regionId String
  region   Region @relation(fields: [regionId], references: [id], onDelete: Cascade)

  @@id([regionId, locale])
}

model Empire {
  id                   String           @id
  slug                 String           @unique
  numberOfAuthors      Int              @default(0)
  numberOfBooks        Int              @default(0)
  createdAt            DateTime         @default(now())
  updatedAt            DateTime?        @updatedAt
  nameTranslations     EmpireName[]
  overviewTranslations EmpireOverview[]
  author               Author[]         @relation("AuthorToEmpire")
  region               Region[]         @relation("RegionToEmpire")
}

model EmpireName {
  locale   String
  text     String
  empireId String
  empire   Empire @relation(fields: [empireId], references: [id], onDelete: Cascade)

  @@id([empireId, locale])
}

model EmpireOverview {
  locale   String
  text     String
  empireId String
  empire   Empire @relation(fields: [empireId], references: [id], onDelete: Cascade)

  @@id([empireId, locale])
}

enum AuthorYearStatus {
  Unknown
  Alive
}

enum BookVersionSource {
  Turath
  Openiti
  Pdf
  External
}
